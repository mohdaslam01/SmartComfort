<!DOCTYPE html><html lang="en"><head><script src="ensure.js"></script><meta charset="UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Live Sensor Chart - SmartComfort</title><style> body { font-family: Arial, sans-serif; background-color: #eef2f3; margin: 0; padding: 20px; text-align: center; } h1 { color: #222; } canvas { background-color: #fff; border: 1px solid #ccc; max-width: 100%; } #status { margin-top: 8px; font-size: 0.9rem; color: #555; } </style></head><body><canvas id="sensorChart" width="1000" height="500"></canvas><div id="status" aria-live="polite"></div><script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1"></script><script> const API_URL = 'http://10.196.133.61:5000/sensor-data'; const ctx = document.getElementById('sensorChart').getContext('2d'); const statusEl = document.getElementById('status'); const MAX_POINTS = 20; const toNum = v => { const n = Number(v); return Number.isFinite(n) ? n : null; }; const chart = new Chart(ctx, { type: 'line', data: { labels: [], datasets: [ { label: 'ðŸŒ¡ï¸ Temperature (Â°C)', data: [], borderWidth: 2, fill: false }, { label: 'ðŸ’§ Humidity (%)', data: [], borderWidth: 2, fill: false }, { label: 'ðŸ’¡ Ambient Light (lux)', data: [], borderWidth: 2, fill: false }, { label: 'ðŸŸ£ Violet', data: [], borderWidth: 2, fill: false }, { label: 'ðŸ”µ Blue', data: [], borderWidth: 2, fill: false }, { label: 'ðŸŸ¢ Green', data: [], borderWidth: 2, fill: false }, { label: 'ðŸŸ¡ Yellow', data: [], borderWidth: 2, fill: false }, { label: 'ðŸŸ  Orange', data: [], borderWidth: 2, fill: false }, { label: 'ðŸ”´ Red', data: [], borderWidth: 2, fill: false } ] }, options: { responsive: true, interaction: { mode: 'index', intersect: false }, animation: false, plugins: { legend: { position: 'top' }, title: { display: true, text: 'SmartComfort â€” Real-Time Sensor Readings' } }, scales: { x: { title: { display: true, text: 'Time' } }, y: { title: { display: true, text: 'Sensor Values' } } } } }); async function fetchAndUpdate() { const ctrl = new AbortController(); const t = setTimeout(() => ctrl.abort(), 8000); try { const res = await fetch(API_URL, { signal: ctrl.signal }); clearTimeout(t); if (!res.ok) throw new Error(`HTTP ${res.status}`); const data = await res.json(); const time = data.timestamp || new Date().toLocaleTimeString(); const series = [ toNum(data.temperature), toNum(data.humidity), toNum(data.lux), toNum(data.violet), toNum(data.blue), toNum(data.green), toNum(data.yellow), toNum(data.orange), toNum(data.red) ]; chart.data.labels.push(time); if (chart.data.labels.length > MAX_POINTS) chart.data.labels.shift(); chart.data.datasets.forEach((ds, i) => { ds.data.push(series[i]); if (ds.data.length > MAX_POINTS) ds.data.shift(); }); chart.update(); statusEl.textContent = `Last update: ${new Date().toLocaleTimeString()}`; } catch (err) { statusEl.textContent = `Data fetch failed: ${err.message}`; } } fetchAndUpdate(); setInterval(fetchAndUpdate, 300000); </script></body></html>